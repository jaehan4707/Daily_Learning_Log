# CPU Scheduler

## 스케쥴러

<aside>
💡 어떤 프로세스에게 자원을 할당할지를 결정하는 운영체제 커널의 모듈을 뜻한다.

</aside>

스케쥴러는 장기,중기, 단기 스케쥴러가 있다.

### 장기 스케줄러(long term scheduler)

<aside>
💡 어떤 프로세스를 레디큐에 넣을 것인가?

</aside>

- 작업 스케줄러라고도 부르며 어떤 프로세스를 레디큐에 삽입할 지를 결정하는 역할을 한다.
    - 디스크에서 하나의 프로그램을 가져와 커널에 등록하면 프로세스가 되는데, 이때 디스크에서 어떤 프로그램을 가져와 커널에 등록할지를 결정한다.
- 장기 스케줄러는 호출의 빈도가 적기 때문에 속도가 느린것이 허용된다.
- 장기 스케줄러는 메모리에 동시에 올라가 있는 프로세스의 수를 조절하는 역할을 한다.
- 하지만 현대의 시분할 시스템에서 사용되는 운영체제에는 일반적으로 장기 스케줄러를 두지 않는 경우가 대부분이다.
    - 과거에는 적은양의 메모리를 많은 프로세스들에게 할당하면 프로세스당 메모리 보유량이 적어져 장기 스케줄러가 이를 조절하는 역할을 했다.
    - 현대의 운영체제에서는 프로세스가 시작되면 장기 스케줄러 없이 바로 그 프로세스에 메모리를 할당해 레디큐에 넣어준다.

### 중기 스케줄러(medium term scheduler)

<aside>
💡 메모리에 적재된 프로세스 수 관리

</aside>

- 너무 많은 프로세스에게 메모리를 할당해 시스템의 성능이 저하되는 경우 이를 해결하기 위해 메모리에 적재된 프로세스의 수를 조절하기 위해 추가된 스케줄러

스와핑

- 장기 스케줄러와 마찬가지로 메모리에 올라와 있는 프로세스의 수를 조절하는 역할을 한다.
    - 만약 메모리에 많은 프로세스가 적재되어 프로세스 당 보유하고 있는 메모리량이 극도로 적어지면 CPU 수행에 필요한 프로세스의 주소 공간조차도 메모리에 올려놓기 어려운 상황이 발생되는데, 이 경우 디스크 I/O가 수시로 발생하게 되어 시스템의 성능이 심각하게 저하될 수 있다.(Trashing)
        - Transhing: 메모리 영역에 접근하게 될 때, 메모리에 Page fault 비율이 높을 것을 의미
    - 이런 경우 메모리에 올라와 있는 프로세스 중 일부의 메모리를 빼앗아 그 내용을 디스크 스왑 영역에 저장한다. → swap out
    - 디스크로 swap out 하는 경우 중단 상태에 있는 프로세스들이 첫번째 대상이다.
        - 중단 상태의 프로세스들은 당장 CPU를 획득할 가능성이 없기 때문
    - 중단 상태의 프로세스들을 swap out 해도 문제가 해결되지 않는 경우 중기 스케줄러는 타이머 인터럽트가 발생해 레디큐로 이동하는 프로세스들을 추가로 swap out 시킨다.
    - 그러다 메모리에 여유가 생기면 적재한다.

중기 스케줄러의 등장으로 프로세스의 상태에는 중지(suspended, stopped) 상태가 추가되었으며, 중지 상태의 프로세스는 메모리를 통째로 빼앗기고 디스크로 스왑 아웃된다.

중지 상태는 중지 준비 상태와 봉쇄 중지 상태가 있다.

- 중지 준비 상태: 준비 상태의 프로세스가 중기 스케줄러에 의해 디스크로 swap out
- 봉쇄 중지 상태 : 봉쇄 상태의 프로세스가 중기 스케줄러에 의해 디스크로 swap out

중지 봉쇄 상태인 프로세스가 봉쇄 되었던 조건을 만족하게 되면 이 프로세스의 상태는 중지 준비 상태로 바뀌게 된다. 중지 상태에 있는 프로세스들은 중지 준비 상태이든 봉쇄 상태이든 관계 없이 메모리를 조금도 보유하지 않고 스왑 아웃된 상태로 디스크에 존재하게 된다.

### 단기 스케줄러(short term scheduler)

<aside>
💡 어떤 프로세스에게 CPU를 할당해 줄 것인가?

</aside>

- CPU 스케줄러라고도 하며 준비 상태의 프로세스 중에서 어떤 프로세스를 다음 번에 실행 상태로 만들것인지를 결정한다. 시분할 시스템에서 타이머 인터럽트가 발생하면 단기 스케줄러가 호출된다.
- 일반적인 스케줄러가 단기 스케줄러에 속하고, 미리 정한 스케줄링 알고리즘에 따라 CPU를 할당 할 프로세스를 선택한다.
- 매우 빈번하게 호출되기 때문에 수행 속도가 빨라야 한다.